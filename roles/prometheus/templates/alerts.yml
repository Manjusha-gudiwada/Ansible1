groups:
- name: Hardware resources
  rules:
  - alert: HighCPU
    expr: cpu_usage_in_percentagev > 90
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "HighCPU on {%raw%}{{ $labels.tagName }}{%endraw%}"

- name: services
  rules:
  - alert: CartServiceDown
    expr: node_systemd_unit_state{name="cart.service",tagName="cart",state="active"} == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: {%raw%}"service {{ $lables.name }} down on {{ $labels.tagName }}"{%endraw%}

  - alert: CatalogueServiceDown
    expr: node_systemd_unit_state{name="catalogue.service",tagName="catalogue",state="active"} == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: {%raw%}"service {{ $lables.name }} down on {{ $labels.tagName }}"{%endraw%}

  - alert: FrontendServiceDown
    expr: node_systemd_unit_state{name="nginx.service",tagName="nginx",state="active"} == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: {%raw%}"service {{ $lables.name }} down on {{ $labels.tagName }}"{%endraw%}

  - alert: UserServiceDown
    expr: node_systemd_unit_state{name="user.service",tagName="user",state="active"} == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: {%raw%}"service {{ $lables.name }} down on {{ $labels.tagName }}"{%endraw%}

  - alert: ShippingServiceDown
    expr: node_systemd_unit_state{name="shipping.service",tagName="shipping",state="active"} == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: {%raw%}"service {{ $lables.name }} down on {{ $labels.tagName }}"{%endraw%}

  - alert: PaymentServiceDown
    expr: node_systemd_unit_state{name="payment.service",tagName="payment",state="active"} == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: {%raw%}"service {{ $lables.name }} down on {{ $labels.tagName }}"{%endraw%}